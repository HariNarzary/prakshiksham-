<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faculty Dashboard - InternshipHub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .modal-enter, .modal-leave { animation-duration: 0.3s; animation-timing-function: ease; animation-fill-mode: forwards; }
        .modal-enter { animation-name: modal-bg-fade-in; }
        .modal-leave { animation-name: modal-bg-fade-out; }
        .modal-content-enter { animation-name: modal-content-scale-in; animation-duration: 0.3s; }
        .modal-content-leave { animation-name: modal-content-scale-out; animation-duration: 0.3s; }
        @keyframes modal-bg-fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes modal-bg-fade-out { from { opacity: 1; } to { opacity: 0; } }
        @keyframes modal-content-scale-in { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes modal-content-scale-out { from { transform: scale(1); opacity: 1; } to { transform: scale(0.9); opacity: 0; } }
        #facultyChart { cursor: pointer; }
    </style>
</head>
<body class="bg-gray-100 text-gray-900">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <nav class="w-64 bg-white shadow-lg h-screen sticky top-0 hidden lg:flex flex-col">
            <div class="p-6 text-center border-b border-gray-200"><h2 class="text-xl font-bold text-blue-600">Faculty Portal</h2></div>
            <ul id="sidebar-links" class="flex-grow p-4 space-y-2">
                 <li><a href="#" data-view="dashboard" class="sidebar-link flex items-center gap-4 p-3 rounded-lg font-semibold"><i data-lucide="layout-dashboard"></i>Dashboard</a></li>
                 <li><a href="#" data-view="tracking" class="sidebar-link flex items-center gap-4 p-3 rounded-lg font-semibold"><i data-lucide="user-check"></i>Student Tracking</a></li>
                 <li><a href="#" data-view="leaderboard" class="sidebar-link flex items-center gap-4 p-3 rounded-lg font-semibold"><i data-lucide="trophy"></i>Leaderboard</a></li>
            </ul>
            <div class="p-4 border-t border-gray-200"><a href="index.html" class="flex items-center gap-3 p-3 rounded-lg text-red-500 hover:bg-red-50 font-semibold"><i data-lucide="log-out" class="w-5 h-5"></i><span>Logout</span></a></div>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col h-screen overflow-y-auto">
             <header class="bg-white shadow-md p-4 flex justify-between items-center sticky top-0 z-40 border-b border-gray-200">
                <div class="flex items-center gap-4"><i data-lucide="school" class="text-blue-600 w-8 h-8"></i><h1 class="text-2xl font-bold hidden sm:block">InternshipHub</h1></div>
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2 p-2">
                        <i data-lucide="user-circle" class="w-8 h-8 rounded-full bg-gray-200 p-1"></i>
                        <span class="font-semibold hidden md:block">Prof. Anjali Desai</span>
                    </div>
                </div>
            </header>

            <div id="faculty-dashboard-content" class="p-4 sm:p-6 lg:p-8"></div>
        </main>
    </div>
    
    <!-- Modal Structure -->
    <div id="modal-backdrop" class="fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 hidden">
        <div id="modal-content" class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl mx-auto border border-gray-200">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 id="modal-title" class="text-xl font-bold">Modal Title</h3>
                <button id="modal-close-btn" class="text-gray-400 hover:text-gray-600"><i data-lucide="x-circle" class="w-6 h-6"></i></button>
            </div>
            <div id="modal-body" class="p-6 max-h-[70vh] overflow-y-auto"></div>
        </div>
    </div>

    <script>
        // --- DATA STORE ---
        let MOCK_DATA = {
            students: [
                // Populated with 15 students, each with new mentorFeedback and milestones properties
                { id: 1, name: 'Priya Sharma', company: 'Innovate Inc.', reportStatus: 'Pending', skills: ['React', 'CSS'], logbook: [{date: '2025-10-04', entry: 'Implemented login page.'}], report: {title: 'Week 4 Report', summary: 'Completed auth flow.'}, mentorFeedback: { rating: 4, comment: "Priya is a quick learner and very proactive." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Feature Dev', completed: true }, { title: 'Testing', completed: false }, { title: 'Final Report', completed: false }] },
                { id: 2, name: 'Alex Johnson', company: 'Creative Solutions', reportStatus: 'Approved', skills: ['Figma', 'UX Research'], logbook: [{date: '2025-10-05', entry: 'Finalized personas.'}], report: {}, mentorFeedback: { rating: 5, comment: "Excellent design sense and great team player." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'User Research', completed: true }, { title: 'Wireframing', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 3, name: 'Michael Chen', company: 'Tech Giants', reportStatus: 'Approved', skills: ['Node.js', 'SQL'], logbook: [{date: '2025-10-02', entry: 'Deployed server.'}], report: {}, mentorFeedback: { rating: 3, comment: "Solid technical skills, but could improve communication." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'API Dev', completed: false }, { title: 'Database Mgmt', completed: false }, { title: 'Final Report', completed: true }] },
                { id: 4, name: 'Samantha Rao', company: 'DataDriven Co.', reportStatus: 'Pending', skills: ['Python', 'Pandas'], logbook: [{date: '2025-10-04', entry: 'Cleaned dataset.'}], report: {title: 'Data Analysis Report', summary: 'Initial EDA complete.'}, mentorFeedback: { rating: 4, comment: "Very analytical and detail-oriented." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Data Cleaning', completed: true }, { title: 'Modeling', completed: true }, { title: 'Final Report', completed: false }] },
                { id: 5, name: 'David Lee', company: 'Innovate Inc.', reportStatus: 'Approved', skills: ['Go', 'Docker'], logbook: [{date: '2025-10-05', entry: 'Refactored endpoints.'}], report: {}, mentorFeedback: { rating: 5, comment: "Exceptional problem-solver. A huge asset to the team." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'API Refactor', completed: true }, { title: 'Deployment', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 6, name: 'Emily White', company: 'Creative Solutions', reportStatus: 'Pending', skills: ['Adobe XD', 'Wireframing'], logbook: [{date: '2025-09-28', entry: 'Project setup.'}], report: {title: 'Week 1 Report', summary: 'Onboarding complete.'}, mentorFeedback: { rating: 3, comment: "Struggled a bit with the new tools but is improving." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'User Research', completed: false }, { title: 'Wireframing', completed: false }, { title: 'Final Report', completed: false }] },
                { id: 7, name: 'Chris Green', company: 'Tech Giants', reportStatus: 'Approved', skills: ['Java', 'Spring'], logbook: [{date: '2025-10-03', entry: 'Fixed critical bug.'}], report: {}, mentorFeedback: { rating: 4, comment: "Very reliable and handles pressure well." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Bug Fixing', completed: true }, { title: 'New Feature', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 8, name: 'Jessica Brown', company: 'DataDriven Co.', reportStatus: 'Approved', skills: ['R', 'Tableau'], logbook: [{date: '2025-10-05', entry: 'Presented findings.'}], report: {}, mentorFeedback: { rating: 5, comment: "Her data visualizations are top-notch." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Data Analysis', completed: true }, { title: 'Dashboard Dev', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 9, name: 'Kevin Harris', company: 'Innovate Inc.', reportStatus: 'Pending', skills: ['Vue.js', 'TypeScript'], logbook: [{date: '2025-10-01', entry: 'Component testing.'}], report: {title: 'Vue Component Library', summary: 'Built new components.'}, mentorFeedback: { rating: 4, comment: "Strong front-end skills." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Component Dev', completed: true }, { title: 'Testing', completed: true }, { title: 'Final Report', completed: false }] },
                { id: 10, name: 'Laura Martinez', company: 'Creative Solutions', reportStatus: 'Approved', skills: ['Sketch', 'Prototyping'], logbook: [{date: '2025-10-05', entry: 'User testing.'}], report: {}, mentorFeedback: { rating: 5, comment: "Invaluable insights from user testing sessions." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'User Research', completed: true }, { title: 'Prototyping', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 11, name: 'Daniel Wilson', company: 'Tech Giants', reportStatus: 'Approved', skills: ['C#', '.NET'], logbook: [{date: '2025-10-04', entry: 'Database migration.'}], report: {}, mentorFeedback: { rating: 4, comment: "Handled a complex migration flawlessly." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Database Mgmt', completed: true }, { title: 'API Dev', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 12, name: 'Olivia Garcia', company: 'DataDriven Co.', reportStatus: 'Approved', skills: ['SQL', 'PowerBI'], logbook: [{date: '2025-10-05', entry: 'Dashboard creation.'}], report: {}, mentorFeedback: { rating: 5, comment: "Quickly became our go-to for PowerBI questions." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Data Analysis', completed: true }, { title: 'Dashboard Dev', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 13, name: 'James Rodriguez', company: 'Innovate Inc.', reportStatus: 'Pending', skills: ['Angular', 'RxJS'], logbook: [{date: '2025-09-30', entry: 'State management.'}], report: {title: 'Angular State', summary: 'Implemented NgRx.'}, mentorFeedback: { rating: 3, comment: "Good progress, but needs to manage time better." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Feature Dev', completed: true }, { title: 'Testing', completed: false }, { title: 'Final Report', completed: false }] },
                { id: 14, name: 'Sophia Hernandez', company: 'Creative Solutions', reportStatus: 'Approved', skills: ['Illustration', 'Animation'], logbook: [{date: '2025-10-05', entry: 'Created assets.'}], report: {}, mentorFeedback: { rating: 5, comment: "Extremely creative and talented." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'Asset Creation', completed: true }, { title: 'Animation', completed: true }, { title: 'Final Report', completed: true }] },
                { id: 15, name: 'William Clark', company: 'Tech Giants', reportStatus: 'Approved', skills: ['Kubernetes', 'AWS'], logbook: [{date: '2025-10-04', entry: 'CI/CD optimization.'}], report: {}, mentorFeedback: { rating: 4, comment: "Great understanding of DevOps principles." }, milestones: [{ title: 'Onboarding', completed: true }, { title: 'CI/CD', completed: true }, { title: 'Deployment', completed: true }, { title: 'Final Report', completed: true }] }
            ]
        };

        // Calculate progress for each student based on milestones
        MOCK_DATA.students.forEach(student => {
            const completedMilestones = student.milestones.filter(m => m.completed).length;
            student.progress = Math.round((completedMilestones / student.milestones.length) * 100);
        });
        
        // --- GLOBAL VARIABLES & HELPERS ---
        const contentArea = document.getElementById('faculty-dashboard-content');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalContent = document.getElementById('modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        let facultyChartSortOrder = 'default';
        let studentChartMap = [];

        const getStarRating = (rating) => {
            let stars = '';
            for (let i = 0; i < 5; i++) {
                stars += `<i data-lucide="star" class="w-4 h-4 ${i < rating ? 'text-yellow-400 fill-current' : 'text-gray-300'}"></i>`;
            }
            return `<div class="flex items-center gap-1">${stars}</div>`;
        };
        
        // --- RENDER FUNCTIONS ---
        let facultyChart = null;
        const renderFacultyChart = () => {
            const ctx = document.getElementById('facultyChart')?.getContext('2d');
            if (!ctx) return;
            if (facultyChart) facultyChart.destroy();

            let studentsForChart = [...MOCK_DATA.students];
            if (facultyChartSortOrder === 'asc') studentsForChart.sort((a, b) => a.progress - b.progress);
            else if (facultyChartSortOrder === 'desc') studentsForChart.sort((a, b) => b.progress - a.progress);
            
            studentChartMap = studentsForChart.map(s => s.id); // Store the order of students in the chart

            facultyChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: studentsForChart.map(s => s.name),
                    datasets: [{
                        label: 'Milestone Completion',
                        data: studentsForChart.map(s => s.progress),
                        backgroundColor: studentsForChart.map(s => {
                            if (s.progress < 40) return 'rgba(239, 68, 68, 0.6)'; // Red
                            if (s.progress < 75) return 'rgba(234, 179, 8, 0.6)'; // Yellow
                            return 'rgba(34, 197, 94, 0.6)'; // Green
                        }),
                        borderColor: studentsForChart.map(s => {
                            if (s.progress < 40) return 'rgba(239, 68, 68, 1)';
                            if (s.progress < 75) return 'rgba(234, 179, 8, 1)';
                            return 'rgba(34, 197, 94, 1)';
                        }),
                        borderWidth: 1,
                        borderRadius: 4,
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const chartElement = elements[0];
                            const studentId = studentChartMap[chartElement.index];
                            showViewStudentProfileModal(studentId);
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: { label: (context) => `Progress: ${context.parsed.x}%` } }
                    },
                    scales: {
                        x: { beginAtZero: true, max: 100, title: { display: true, text: 'Milestone Completion (%)' } },
                        y: { grid: { display: false } }
                    }
                }
            });
        };

        const renderDashboardView = () => {
            const pendingReports = MOCK_DATA.students.filter(s => s.reportStatus === 'Pending').length;
            contentArea.innerHTML = `
            <div class="space-y-6 fade-in">
                <div class="bg-white rounded-xl shadow-lg p-6 border">
                    <h3 class="text-2xl font-bold mb-4">Welcome, Prof. Desai!</h3>
                    <p class="text-gray-600">Here's an overview of your students' internship progress.</p>
                </div>
                <div class="grid lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-1 space-y-6">
                        <div class="bg-white rounded-xl shadow-lg p-6 border"><h4 class="font-bold text-lg mb-2">Total Students</h4><p class="text-4xl font-bold text-blue-600">${MOCK_DATA.students.length}</p></div>
                        <div class="bg-white rounded-xl shadow-lg p-6 border"><h4 class="font-bold text-lg mb-2">Pending Reports</h4><p class="text-4xl font-bold text-yellow-500">${pendingReports}</p></div>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-6 border lg:col-span-2">
                        <div class="flex justify-between items-center mb-4">
                             <h4 class="font-bold text-lg">Milestone Completion Rate</h4>
                             <div class="flex items-center gap-2">
                                <button id="sort-asc-btn" class="px-3 py-1 text-xs rounded-md bg-gray-200 hover:bg-gray-300 font-semibold flex items-center gap-1" title="Sort Ascending">Sort <i data-lucide="arrow-up" class="w-3 h-3"></i></button>
                                <button id="sort-desc-btn" class="px-3 py-1 text-xs rounded-md bg-gray-200 hover:bg-gray-300 font-semibold flex items-center gap-1" title="Sort Descending">Sort <i data-lucide="arrow-down" class="w-3 h-3"></i></button>
                             </div>
                        </div>
                        <div class="h-[450px]"><canvas id="facultyChart"></canvas></div>
                    </div>
                </div>
            </div>`;
            lucide.createIcons();
            renderFacultyChart();

            document.getElementById('sort-asc-btn')?.addEventListener('click', () => { facultyChartSortOrder = 'asc'; renderFacultyChart(); });
            document.getElementById('sort-desc-btn')?.addEventListener('click', () => { facultyChartSortOrder = 'desc'; renderFacultyChart(); });
        };
        
        const renderTrackingView = () => {
            contentArea.innerHTML = `
            <div class="bg-white rounded-xl shadow-lg p-6 fade-in border">
                <h3 class="text-2xl font-bold mb-4">Student Internship Tracking</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm whitespace-nowrap">
                        <thead>
                            <tr class="border-b">
                                <th class="text-left p-3 font-semibold">Student Name</th>
                                <th class="text-left p-3 font-semibold">Company</th>
                                <th class="text-left p-3 font-semibold">Mentor Rating</th>
                                <th class="text-left p-3 font-semibold">Last Activity</th>
                                <th class="text-left p-3 font-semibold">Report Status</th>
                                <th class="text-left p-3 font-semibold">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${MOCK_DATA.students.map(s => {
                                const lastLog = s.logbook.length > 0 ? new Date(s.logbook[0].date).toLocaleDateString() : 'N/A';
                                return `
                                <tr class="border-b">
                                    <td class="p-3 font-semibold">${s.name}</td>
                                    <td class="p-3">${s.company}</td>
                                    <td class="p-3">${getStarRating(s.mentorFeedback.rating)}</td>
                                    <td class="p-3">${lastLog}</td>
                                    <td class="p-3"><span class="px-2 py-1 text-xs rounded-full ${s.reportStatus === 'Approved' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">${s.reportStatus}</span></td>
                                    <td class="p-3 flex gap-4">
                                        <button onclick="showViewStudentProfileModal(${s.id})" class="text-gray-500 hover:text-purple-600" title="View Profile"><i data-lucide="user"></i></button>
                                        <button onclick="showViewLogbookModal(${s.id})" class="text-gray-500 hover:text-blue-600" title="View Logbook"><i data-lucide="book-open"></i></button>
                                        <button onclick="showReviewReportModal(${s.id})" class="text-gray-500 hover:text-green-600" title="Review Report"><i data-lucide="file-check"></i></button>
                                    </td>
                                </tr>`;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            </div>`;
            lucide.createIcons();
        };

        const renderLeaderboardView = () => { /* Unchanged */ contentArea.innerHTML = `<div class="bg-white rounded-xl shadow-lg p-6 fade-in border"><h3 class="text-2xl font-bold mb-4">Student Leaderboard</h3><div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="border-b"><th class="text-left p-3 font-semibold">Rank</th><th class="text-left p-3 font-semibold">Name</th><th class="text-left p-3 font-semibold">Points</th></tr></thead><tbody>${MOCK_DATA.students.sort((a,b) => b.progress - a.progress).map((s, i) => `<tr class="border-b"><td class="p-3 font-bold text-xl">${i+1}</td><td class="p-3 font-semibold">${s.name}</td><td class="p-3 font-bold text-blue-600">${Math.round(s.progress * 10 + s.mentorFeedback.rating * 20)} pts</td></tr>`).join('')}</tbody></table></div></div>`; lucide.createIcons(); };
        
        // --- MODAL FUNCTIONS ---
        const showModal = (title, bodyHtml) => { /* Unchanged */ modalTitle.innerHTML = title; modalBody.innerHTML = bodyHtml; modalBackdrop.classList.remove('hidden', 'modal-leave'); modalBackdrop.classList.add('modal-enter'); modalContent.classList.remove('modal-content-leave'); modalContent.classList.add('modal-content-enter'); };
        window.hideModal = () => { /* Unchanged */ modalBackdrop.classList.add('modal-leave'); modalContent.classList.add('modal-content-leave'); setTimeout(() => { modalBackdrop.classList.add('hidden'); }, 300); };

        window.showViewStudentProfileModal = (studentId) => {
            const student = MOCK_DATA.students.find(s => s.id === studentId);
            if (!student) return;
            const bodyHtml = `
            <div class="space-y-6">
                <div>
                    <h4 class="font-semibold text-lg">Interning at ${student.company}</h4>
                    <p class="text-gray-600">Overall Progress: ${student.progress}%</p>
                </div>
                <div class="border-t pt-4">
                    <h4 class="font-semibold text-lg mb-2">Milestone Progress</h4>
                    <div class="space-y-2">
                        ${student.milestones.map(m => `
                        <div class="flex items-center gap-3">
                            <i data-lucide="${m.completed ? 'check-circle-2' : 'circle'}" class="w-5 h-5 ${m.completed ? 'text-green-500' : 'text-gray-400'}"></i>
                            <span>${m.title}</span>
                        </div>`).join('')}
                    </div>
                </div>
                <div class="border-t pt-4">
                    <h4 class="font-semibold text-lg">Mentor Feedback</h4>
                    <div class="flex items-center gap-4 mt-2">
                        ${getStarRating(student.mentorFeedback.rating)}
                        <p class="text-sm font-semibold">(${student.mentorFeedback.rating}/5)</p>
                    </div>
                    <blockquote class="mt-2 pl-4 border-l-4 italic text-gray-600">"${student.mentorFeedback.comment}"</blockquote>
                </div>
            </div>
            <div class="flex justify-end pt-6 border-t mt-6"><button type="button" onclick="hideModal()" class="px-4 py-2 rounded-lg bg-gray-200 font-semibold">Close</button></div>`;
            showModal(`Profile: ${student.name}`, bodyHtml);
            lucide.createIcons();
        };

        window.showViewLogbookModal = (studentId) => { /* Unchanged */ const student = MOCK_DATA.students.find(s => s.id === studentId); if (!student) return; const logEntries = student.logbook.length > 0 ? student.logbook.map(l => `<div class="border-l-4 border-blue-500 pl-4 py-2"><p class="font-semibold">${new Date(l.date).toLocaleDateString()}</p><p class="text-gray-600">${l.entry}</p></div>`).join('') : '<p class="text-gray-500">No logbook entries.</p>'; const bodyHtml = `<div class="space-y-4">${logEntries}</div><div class="flex justify-end pt-6 border-t mt-6"><button type="button" onclick="hideModal()" class="px-4 py-2 rounded-lg bg-gray-200 font-semibold">Close</button></div>`; showModal(`Logbook for ${student.name}`, bodyHtml);};
        window.showReviewReportModal = (studentId) => { /* Unchanged */ const student = MOCK_DATA.students.find(s => s.id === studentId); if (!student || !student.report.title) { showModal(`Review Report for ${student.name}`, `<p class="text-gray-500">No report submitted.</p><div class="flex justify-end pt-6 border-t mt-6"><button type="button" onclick="hideModal()" class="px-4 py-2 rounded-lg bg-gray-200 font-semibold">Close</button></div>`); return; } const bodyHtml = `<div class="space-y-4"><h4 class="font-bold text-lg">${student.report.title}</h4><p class="text-gray-600">${student.report.summary}</p><div class="border-t pt-4"><label class="font-semibold mb-2 block">Feedback</label><textarea class="w-full p-2 rounded bg-gray-100 border" rows="3"></textarea></div></div><div class="flex justify-end gap-3 pt-6 border-t mt-6"><button type="button" onclick="hideModal()" class="px-4 py-2 rounded-lg bg-gray-200 font-semibold">Cancel</button><button type="button" onclick="hideModal()" class="px-4 py-2 rounded-lg bg-red-600 text-white font-semibold">Reject</button><button type="button" onclick="hideModal()" class="px-4 py-2 rounded-lg bg-green-600 text-white font-semibold">Approve</button></div>`; showModal(`Review Report for ${student.name}`, bodyHtml); };

        // --- APP LOGIC & NAVIGATION ---
        const setActiveLink = (view) => { /* Unchanged */ document.querySelectorAll('.sidebar-link').forEach(link => { if (link.dataset.view === view) { link.classList.add('bg-blue-50', 'text-blue-600'); link.classList.remove('text-gray-600', 'hover:bg-gray-100'); } else { link.classList.remove('bg-blue-50', 'text-blue-600'); link.classList.add('text-gray-600', 'hover:bg-gray-100'); } }); };
        const switchView = (view) => { /* Unchanged */ switch (view) { case 'tracking': renderTrackingView(); break; case 'leaderboard': renderLeaderboardView(); break; default: renderDashboardView(); } setActiveLink(view); };

        // --- APP INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.sidebar-link').forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); switchView(link.dataset.view); }); });
            document.getElementById('modal-close-btn').addEventListener('click', hideModal);
            modalBackdrop.addEventListener('click', e => e.target === modalBackdrop && hideModal());
            switchView('dashboard');
        });
    </script>
</body>
</html>


